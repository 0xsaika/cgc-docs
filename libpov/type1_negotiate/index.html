<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
    <meta content='width=device-width, initial-scale=1' name='viewport'>
    <title>type1_negotiate</title>
    <link href="../../assets/stylesheets/application.css" rel="stylesheet" />
  </head>
  <body class='libpov libpov_type1_negotiate libpov_type1_negotiate_index'>
    <div id='container'>
      <div id='nav_col'>
        <div id='logo'>
          <a href='/'>
            CGC Docs, published by Legitimate Business Syndicate
          </a>
        </div>
        <div id='nav'>
          <ul>
            <li>
              <a href='/'>CGC Docs</a>
            </li>
            <li class='hdr'>Event-FAQ</li>
            <li>
              <a href='/Event-FAQ/event_faq/'>Event FAQ</a>
            </li>
            <li class='hdr'>cb-testing</li>
            <li>
              <a href='/cb-testing/cb-acceptance/'>cb-acceptance</a>
            </li>
            <li>
              <a href='/cb-testing/cb-replay/'>cb-replay</a>
            </li>
            <li>
              <a href='/cb-testing/cb-replay-pov/'>cb-replay-pov</a>
            </li>
            <li>
              <a href='/cb-testing/cb-test/'>cb-test</a>
            </li>
            <li>
              <a href='/cb-testing/poll-validate/'>poll-validate</a>
            </li>
            <li class='hdr'>cgc-release-documentation/newsletter</li>
            <li>
              <a href='/cgc-release-documentation/newsletter/ipc/'>News Letter 1: IPC</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/newsletter/cpp/'>News Letter 2: C++</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/newsletter/ctf/'>News Letter 3: CTF</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/newsletter/template/'>News Letter X: Template</a>
            </li>
            <li class='hdr'>cgc-release-documentation/walk-throughs</li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/building-a-cb/'>Building a Challenge Binary</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/cgc-repository/'>CGC Repositories</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/debugging-a-cb/'>Debugging a Challenge Binary</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/pin-for-decree/'>Running Intel PIN on DECREE Challenge Binaries</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/running-the-vm/'>Running the Virtual Machine</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/scoring-cbs/'>Scoring a Challenge Binary Set</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/submitting-a-cb/'>Submitting a Challenge Binary</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/testing-a-cb/'>Testing a Challenge Binary</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/understanding-poll-generators/'>Understanding Poll Generators</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/understanding-cfe-povs/'>Understanding Proofs of Vulnerability in CFE</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/using-the-network-appliance/'>Using the Network Appliance</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/virtual-competiton/'>Virtual Competition</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/ptrace-for-decree/'>Writing an Instruction Tracer for DECREE Challenge Binaries Using ptrace</a>
            </li>
            <li class='hdr'>cgc2elf</li>
            <li>
              <a href='/cgc2elf/cgc2elf/'>cgc2elf</a>
            </li>
            <li class='hdr'>cgcef-verify</li>
            <li>
              <a href='/cgcef-verify/cgcef_verify/'>cgcef_verify</a>
            </li>
            <li class='hdr'>libcgc</li>
            <li>
              <a href='/libcgc/allocate/'>allocate</a>
            </li>
            <li>
              <a href='/libcgc/cgcabi/'>CGC ABI</a>
            </li>
            <li>
              <a href='/libcgc/deallocate/'>deallocate</a>
            </li>
            <li>
              <a href='/libcgc/fdwait/'>fdwait</a>
            </li>
            <li>
              <a href='/libcgc/random/'>random</a>
            </li>
            <li>
              <a href='/libcgc/receive/'>receive</a>
            </li>
            <li>
              <a href='/libcgc/terminate/'>_terminate</a>
            </li>
            <li>
              <a href='/libcgc/transmit/'>transmit</a>
            </li>
            <li class='hdr'>libcgcef</li>
            <li>
              <a href='/libcgcef/cgc_executable_format/'>CGC Executable Format</a>
            </li>
            <li class='hdr'>libpov</li>
            <li>
              <a href='/libpov/libpov/'>libpov</a>
            </li>
            <li>
              <a href='/libpov/type1_negotiate/'>type1_negotiate</a>
            </li>
            <li>
              <a href='/libpov/type2_negotiate/'>type2_negotiate</a>
            </li>
            <li>
              <a href='/libpov/type2_submit/'>type2_submit</a>
            </li>
            <li class='hdr'>network-appliance</li>
            <li>
              <a href='/network-appliance/cb-packet-log/'>cb-packet-log</a>
            </li>
            <li>
              <a href='/network-appliance/cb-proxy/'>cb-proxy</a>
            </li>
            <li>
              <a href='/network-appliance/verify-rules/'>verify-rules</a>
            </li>
            <li class='hdr'>poll-generator</li>
            <li>
              <a href='/poll-generator/generate-polls/'>generate-polls</a>
            </li>
            <li class='hdr'>pov-xml2c</li>
            <li>
              <a href='/pov-xml2c/pov-xml2c/'>pov-xml2c</a>
            </li>
            <li class='hdr'>service-launcher</li>
            <li>
              <a href='/service-launcher/cb-server/'>cb-server</a>
            </li>
            <li class='hdr'>virtual-competition</li>
            <li>
              <a href='/virtual-competition/ti-client/'>ti-client</a>
            </li>
            <li>
              <a href='/virtual-competition/ti-rotate/'>ti-rotate</a>
            </li>
            <li>
              <a href='/virtual-competition/ti-server/'>ti-server</a>
            </li>
          </ul>
        </div>
      </div>
      <div id='main_col'>
        <div id='title'>
          <h1>type1_negotiate</h1>
        </div>
        <div id='content'>
          <p><em>type1_negotiate</em> - negotiate a Type 1 POV</p>
          
          <h1 id="library">LIBRARY</h1>
          <p>library "libpov"</p>
          
          <h1 id="synopsis">SYNOPSIS</h1>
          
          <div class="language-c highlighter-rouge"><pre class="highlight"><code><span class="cp">#include &lt;libpov.h&gt;&#x000A;</span>&#x000A;<span class="kt">int</span> <span class="n">type1_negotiate</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ipmask</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">regmask</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">regnum</span><span class="p">,</span> <span class="n">type1_vals</span> <span class="o">*</span><span class="n">t1vals</span><span class="p">)</span>&#x000A;</code></pre>
          </div>
          
          <h1 id="description">DESCRIPTION</h1>
          <p>The <code class="highlighter-rouge">type1_negotiate</code> function performs a CGC Type 1 POV negotiation by
          registering the supplied <code class="highlighter-rouge">ipmask</code>, <code class="highlighter-rouge">regmask</code>, and <code class="highlighter-rouge">regnum</code> values with the
          CFE competition framework, which in return specifies register and IP values
          that the POV is required to use in order to demonstrate a successful POV.</p>
          
          <p><code class="highlighter-rouge">ipmask</code> and <code class="highlighter-rouge">regmask</code> indicate the callers degree of control over EIP and
          a general purpose register named by <code class="highlighter-rouge">regnum</code> according to the following list:</p>
          
          <ul>
            <li>0: <code class="highlighter-rouge">eax</code></li>
            <li>1: <code class="highlighter-rouge">ecx</code></li>
            <li>2: <code class="highlighter-rouge">edx</code></li>
            <li>3: <code class="highlighter-rouge">ebx</code></li>
            <li>4: <code class="highlighter-rouge">esp</code></li>
            <li>5: <code class="highlighter-rouge">ebp</code></li>
            <li>6: <code class="highlighter-rouge">esi</code></li>
            <li>7: <code class="highlighter-rouge">edi</code></li>
          </ul>
          
          <h1 id="return-value">RETURN VALUE</h1>
          <p>On success, zero is returned and the <code class="highlighter-rouge">t1vals</code> structure is populated with the
          IP and register value that the POV is required to use in order to demonstrate
          a successful POV. At the time of the crash the following must be true of the
          crashing CB state:</p>
          
          <div class="language-c highlighter-rouge"><pre class="highlight"><code>  <span class="p">(</span><span class="n">crash_eip</span> <span class="o">&amp;</span> <span class="n">ipmask</span><span class="p">)</span> <span class="o">==</span> <span class="n">t1vals</span><span class="o">-&gt;</span><span class="n">ipval</span> &#x000A;  <span class="p">(</span><span class="n">crash_REG</span> <span class="o">&amp;</span> <span class="n">regmask</span><span class="p">)</span> <span class="o">==</span> <span class="n">t1vals</span><span class="o">-&gt;</span><span class="n">regval</span>&#x000A;</code></pre>
          </div>
          
          <p>On error, -1 is returned and <code class="highlighter-rouge">t1vals</code> is undefined.</p>
          
          <h1 id="see-also">SEE ALSO</h1>
          <p><a href="/libpov/type2_negotiate/">type2_negotiate(3)</a>,
          <a href="/libpov/type2_submit/">type2_submit(3)</a></p>
        </div>
      </div>
    </div>
    <footer>
      <div id='impressum'>Published by Legitimate Business Syndicate</div>
      <div id='timestamp'>Built at 2016-05-20T17:40:32Z</div>
      <div>
        <ul>
          <li><a href="https://legitbs.net">Homepage</a></li>
          <li><a href="https://twitter.com/legitbs_ctf">Twitter</a></li>
          <li><a href="https://github.com/legitbs">GitHub</a></li>
          <li><a href="https://github.com/legitbs/cgc-docs">This repo</a></li>
        </ul>
      </div>
    </footer>
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="../../assets/javascripts/application.js"></script>
  </body>
</html>

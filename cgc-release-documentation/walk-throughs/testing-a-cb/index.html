<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
    <meta content='width=device-width, initial-scale=1' name='viewport'>
    <link href='../../../assets/images/businesscore-64x64.png' rel='icon'>
    <title>CGC Docs | Testing a Challenge Binary</title>
    <link href="../../../assets/stylesheets/application.css" rel="stylesheet" />
  </head>
  <body class='cgc-release-documentation cgc-release-documentation_walk-throughs cgc-release-documentation_walk-throughs_testing-a-cb cgc-release-documentation_walk-throughs_testing-a-cb_index'>
    <div id='container'>
      <div id='nav_col'>
        <div id='logo'>
          <a href='/'>
            CGC Docs, published by Legitimate Business Syndicate
          </a>
        </div>
        <div id='nav'>
          <ul>
            <li>
              <a href='/'>Welcome</a>
            </li>
            <li class='hdr'>Event-FAQ</li>
            <li>
              <a href='/Event-FAQ/event_faq/'>Event FAQ</a>
            </li>
            <li class='hdr'>cb-testing</li>
            <li>
              <a href='/cb-testing/cb-acceptance/'>cb-acceptance</a>
            </li>
            <li>
              <a href='/cb-testing/cb-replay/'>cb-replay</a>
            </li>
            <li>
              <a href='/cb-testing/cb-replay-pov/'>cb-replay-pov</a>
            </li>
            <li>
              <a href='/cb-testing/cb-test/'>cb-test</a>
            </li>
            <li>
              <a href='/cb-testing/poll-validate/'>poll-validate</a>
            </li>
            <li class='hdr'>cgc-release-documentation/newsletter</li>
            <li>
              <a href='/cgc-release-documentation/newsletter/ipc/'>News Letter 1: IPC</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/newsletter/cpp/'>News Letter 2: C++</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/newsletter/ctf/'>News Letter 3: CTF</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/newsletter/template/'>News Letter X: Template</a>
            </li>
            <li class='hdr'>cgc-release-documentation/walk-throughs</li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/building-a-cb/'>Building a Challenge Binary</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/cgc-repository/'>CGC Repositories</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/debugging-a-cb/'>Debugging a Challenge Binary</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/pin-for-decree/'>Running Intel PIN on DECREE Challenge Binaries</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/running-the-vm/'>Running the Virtual Machine</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/scoring-cbs/'>Scoring a Challenge Binary Set</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/submitting-a-cb/'>Submitting a Challenge Binary</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/testing-a-cb/'>Testing a Challenge Binary</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/understanding-poll-generators/'>Understanding Poll Generators</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/understanding-cfe-povs/'>Understanding Proofs of Vulnerability in CFE</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/using-the-network-appliance/'>Using the Network Appliance</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/virtual-competiton/'>Virtual Competition</a>
            </li>
            <li>
              <a href='/cgc-release-documentation/walk-throughs/ptrace-for-decree/'>Writing an Instruction Tracer for DECREE Challenge Binaries Using ptrace</a>
            </li>
            <li class='hdr'>cgc2elf</li>
            <li>
              <a href='/cgc2elf/cgc2elf/'>cgc2elf</a>
            </li>
            <li class='hdr'>cgcef-verify</li>
            <li>
              <a href='/cgcef-verify/cgcef_verify/'>cgcef_verify</a>
            </li>
            <li class='hdr'>libcgc</li>
            <li>
              <a href='/libcgc/allocate/'>allocate</a>
            </li>
            <li>
              <a href='/libcgc/cgcabi/'>CGC ABI</a>
            </li>
            <li>
              <a href='/libcgc/deallocate/'>deallocate</a>
            </li>
            <li>
              <a href='/libcgc/fdwait/'>fdwait</a>
            </li>
            <li>
              <a href='/libcgc/random/'>random</a>
            </li>
            <li>
              <a href='/libcgc/receive/'>receive</a>
            </li>
            <li>
              <a href='/libcgc/terminate/'>_terminate</a>
            </li>
            <li>
              <a href='/libcgc/transmit/'>transmit</a>
            </li>
            <li class='hdr'>libcgcef</li>
            <li>
              <a href='/libcgcef/cgc_executable_format/'>CGC Executable Format</a>
            </li>
            <li class='hdr'>libpov</li>
            <li>
              <a href='/libpov/libpov/'>libpov</a>
            </li>
            <li>
              <a href='/libpov/type1_negotiate/'>type1_negotiate</a>
            </li>
            <li>
              <a href='/libpov/type2_negotiate/'>type2_negotiate</a>
            </li>
            <li>
              <a href='/libpov/type2_submit/'>type2_submit</a>
            </li>
            <li class='hdr'>network-appliance</li>
            <li>
              <a href='/network-appliance/cb-packet-log/'>cb-packet-log</a>
            </li>
            <li>
              <a href='/network-appliance/cb-proxy/'>cb-proxy</a>
            </li>
            <li>
              <a href='/network-appliance/verify-rules/'>verify-rules</a>
            </li>
            <li class='hdr'>poll-generator</li>
            <li>
              <a href='/poll-generator/generate-polls/'>generate-polls</a>
            </li>
            <li class='hdr'>pov-xml2c</li>
            <li>
              <a href='/pov-xml2c/pov-xml2c/'>pov-xml2c</a>
            </li>
            <li class='hdr'>service-launcher</li>
            <li>
              <a href='/service-launcher/cb-server/'>cb-server</a>
            </li>
            <li class='hdr'>virtual-competition</li>
            <li>
              <a href='/virtual-competition/ti-client/'>ti-client</a>
            </li>
            <li>
              <a href='/virtual-competition/ti-rotate/'>ti-rotate</a>
            </li>
            <li>
              <a href='/virtual-competition/ti-server/'>ti-server</a>
            </li>
          </ul>
        </div>
      </div>
      <div id='main_col'>
        <div id='title'>
          <h1>Testing a Challenge Binary</h1>
        </div>
        <div id='content'>
          <p>This walk-through will guide you through testing a challenge binary.</p>
          
          <p>Challenge binary authors are required to provide automated verification of their challenge binaries, verifying the functionality and vulnerabilities contained within their submissions.  In CFE, it is required that polls be generated using a poll generator capable of generating at least 1,000,000 unique polls (See <a href="/cgc-release-documentation/walk-throughs/understanding-poll-generators/">understanding-poll-generators.md</a> for more information on this specification). PoVs may be expressed using XML conforming to cfe-pov.dtd or in the form of a CGC binary.</p>
          
          <p>Each of these commands assume a CWD within a DECREE environment with the <code class="highlighter-rouge">cgc-sample-challenges</code> package installed.  Before starting, change the current working directory to the following:</p>
          
          <div class="highlighter-rouge"><pre class="highlight"><code>/usr/share/cgc-sample-challenges/templates/service-template&#x000A;</code></pre>
          </div>
          
          <h2 id="testing-a-cb">Testing a CB</h2>
          <p>The CB build process provides mechanisms for testing challenge binaries during the build-process.  However, it may be beneficial to test the binaries in a more manual fashion.</p>
          
          <p>Use 'cb-test' to run the tests in the same fashion as performed by the build process.  This is done via the commands:</p>
          
          <div class="highlighter-rouge"><pre class="highlight"><code>$ sudo cb-test --port 10000 --cb LUNGE_00001 --xml poller/for-release/service-1.xml --directory bin&#x000A;</code></pre>
          </div>
          
          <p>This command will test the challenge binary <code class="highlighter-rouge">LUNGE_00001</code> in the directory <code class="highlighter-rouge">bin</code>, using the XML file <code class="highlighter-rouge">poller/for-release/service-1.xml</code>, on TCP port 10000.  The results of the test will be printed to STDOUT in the TAP format.</p>
          
          <p>This should result in the following output:</p>
          
          <div class="highlighter-rouge"><pre class="highlight"><code># command line: /usr/bin/cb-test --port 10000 --cb LUNGE_00001 --xml poller/for-release/service-1.xml --directory bin&#x000A;# launching poll-validate poller/for-release/service-1.xml&#x000A;# launching cb-server --insecure -p 10000 -d bin LUNGE_00001&#x000A;# launching cb-replay --host 127.29.173.154 --port 10000 poller/for-release/service-1.xml&#x000A;# service - poller/for-release/service-1.xml&#x000A;ok 1 - slept 0.010000&#x000A;ok 2 - set values: 'it_is_hello'&#x000A;ok 3 - set values: 'my_name'&#x000A;# received 5468697320696d706c656d656e747320612073696d706c65206563686f&#x000A;ok 4 - match: string&#x000A;ok 5 - set foo to 5468697320696d706c65&#x000A;# received 20736572766963650a&#x000A;ok 6 - match: string&#x000A;ok 7 - set bar to 20736572766963650a&#x000A;# writing: 68656c6c6f2074686572650a&#x000A;ok 8 - write: sent 12 bytes&#x000A;# received 68656c6c6f2074686572650a&#x000A;ok 9 - match: string&#x000A;# writing: 48656c6c6f206d6f6d0a&#x000A;ok 10 - write: sent 10 bytes&#x000A;# received 48656c6c6f206d6f6d0a&#x000A;ok 11 - match: string (expanded from 'it_is_hello')&#x000A;ok 12 - match: string&#x000A;# writing: 48656c6c6f206461640a&#x000A;ok 13 - write: sent 10 bytes&#x000A;ok 14 - bytes received&#x000A;# received 48656c6c6f206461640a&#x000A;ok 15 - match: string&#x000A;ok 16 - match: pcre&#x000A;ok 17 - match: string&#x000A;# writing: 48656c6c6f20736973746572&#x000A;ok 18 - write: sent 12 bytes&#x000A;ok 19 - bytes received&#x000A;# received 48656c6c6f2073697374&#x000A;ok 20 - match: not string&#x000A;# variables at end of interaction:&#x000A;# 'bar' : ' service\n'&#x000A;# 'my_name' : 'hello there'&#x000A;# 'it_is_hello' : 'Hello'&#x000A;# 'foo' : 'This imple'&#x000A;# passed: 20&#x000A;# failed: 0&#x000A;# total passed: 20&#x000A;# total failed: 0&#x000A;# terminating cb-server&#x000A;</code></pre>
          </div>
          
          <h2 id="running-the-tests-by-hand">Running the tests by hand</h2>
          <p>The <code class="highlighter-rouge">cb-test</code> tool runs a number of commands under the hood that may be beneficial to run manually.</p>
          
          <h3 id="running-a-tcp-listener">Running a TCP Listener</h3>
          <p>To run an inetd-style TCP listener for a challenge binary, use the cb-server tool.</p>
          
          <div class="highlighter-rouge"><pre class="highlight"><code>$ cb-server --insecure -p 10000 -d bin LUNGE_00001&#x000A;</code></pre>
          </div>
          
          <p>This command will create a TCP listener on port 10000 that spawns an instance of /bin/echo upon incoming connections without any security restrictions.</p>
          
          <p>Each connection should result in output similar to the following output:</p>
          
          <div class="highlighter-rouge"><pre class="highlight"><code>connection from: 127.0.0.1:33170&#x000A;</code></pre>
          </div>
          
          <h3 id="validate-the-syntax-of-a-pov-or-poll">Validate the syntax of a POV or Poll</h3>
          <p>To validate a POV or Poll follows the XML DTD, use the <code class="highlighter-rouge">poll-validate</code> command.</p>
          
          <div class="highlighter-rouge"><pre class="highlight"><code>$ poll-validate pov/*.xml&#x000A;</code></pre>
          </div>
          
          <p>This command will validate all files ending in .xml in the pov directory follow the DTD specification for POVs.</p>
          
          <p>This should result in no output, provided the XML files follow the DTD specification.  Any errors should be identified and resolved.</p>
          
          <h3 id="test-a-pov-or-poll-against-a-service">Test a POV or POLL against a service</h3>
          <p>To test the efficacy of a POV or POLL against a service, use the <code class="highlighter-rouge">cb-replay</code> command.</p>
          
          <div class="highlighter-rouge"><pre class="highlight"><code>From one 'vagrant ssh' window&#x000A;$ cd /usr/share/cgc-sample-challenges/templates/service-template&#x000A;$ cb-server --insecure -p 10000 -d bin LUNGE_00001&#x000A;&#x000A;From another 'vagrant ssh' window&#x000A;$ cd /usr/share/cgc-sample-challenges/templates/service-template&#x000A;$ cb-replay --host 127.0.0.1 --port 10000 poller/for-release/service-1.xml poller/for-release/service-2.xml&#x000A;</code></pre>
          </div>
          
          <p>This command will test the challenge binary listening on port <code class="highlighter-rouge">10000</code> on the IP address <code class="highlighter-rouge">127.0.0.1</code> with the Poll/POVs <code class="highlighter-rouge">poller/for-release/service-1.xml</code> and <code class="highlighter-rouge">poller/for-release/service-2.xml</code>.</p>
          
          <p>This should result in the following output:</p>
          
          <div class="highlighter-rouge"><pre class="highlight"><code># service - poller/for-release/service-1.xml&#x000A;ok 1 - slept 0.010000&#x000A;ok 2 - set values: 'it_is_hello'&#x000A;ok 3 - set values: 'my_name'&#x000A;# received 5468697320696d706c656d656e747320612073696d706c65206563686f&#x000A;ok 4 - match: string&#x000A;ok 5 - set foo to 5468697320696d706c65&#x000A;# received 20736572766963650a&#x000A;ok 6 - match: string&#x000A;ok 7 - set bar to 20736572766963650a&#x000A;# writing: 68656c6c6f2074686572650a&#x000A;ok 8 - write: sent 12 bytes&#x000A;# received 68656c6c6f2074686572650a&#x000A;ok 9 - match: string&#x000A;# writing: 48656c6c6f206d6f6d0a&#x000A;ok 10 - write: sent 10 bytes&#x000A;# received 48656c6c6f206d6f6d0a&#x000A;ok 11 - match: string (expanded from 'it_is_hello')&#x000A;ok 12 - match: string&#x000A;# writing: 48656c6c6f206461640a&#x000A;ok 13 - write: sent 10 bytes&#x000A;ok 14 - bytes received&#x000A;# received 48656c6c6f206461640a&#x000A;ok 15 - match: string&#x000A;ok 16 - match: pcre&#x000A;ok 17 - match: string&#x000A;# writing: 48656c6c6f20736973746572&#x000A;ok 18 - write: sent 12 bytes&#x000A;ok 19 - bytes received&#x000A;# received 48656c6c6f2073697374&#x000A;ok 20 - match: not string&#x000A;# variables at end of interaction:&#x000A;# 'bar' : ' service\n'&#x000A;# 'my_name' : 'hello there'&#x000A;# 'it_is_hello' : 'Hello'&#x000A;# 'foo' : 'This imple'&#x000A;# passed: 20&#x000A;# failed: 0&#x000A;# service - poller/for-release/service-2.xml&#x000A;ok 1 - slept 0.025000&#x000A;# received 5468697320696d706c656d656e747320612073696d706c65206563686f20736572766963650a&#x000A;ok 2 - match: string&#x000A;ok 3 - slept 0.010000&#x000A;ok 4 - write: sent 10 bytes&#x000A;ok 5 - slept 0.010000&#x000A;# received 48656c6c6f206d6f6d0a&#x000A;ok 6 - match: string&#x000A;ok 7 - slept 0.010000&#x000A;ok 8 - write: sent 10 bytes&#x000A;ok 9 - slept 0.010000&#x000A;# received 48656c6c6f206461640a&#x000A;ok 10 - match: string&#x000A;# passed: 10&#x000A;# failed: 0&#x000A;# total passed: 30&#x000A;# total failed: 0&#x000A;</code></pre>
          </div>
          
          <h2 id="see-also">SEE ALSO</h2>
          
          <p>For information regarding the TAP Format, see <a href="http://testanything.org/">http://testanything.org/</a></p>
        </div>
      </div>
    </div>
    <footer>
      <div id='impressum'>Published by Legitimate Business Syndicate</div>
      <div id='timestamp'>Built at 2016-05-20T22:02:48Z</div>
      <div>
        <ul>
          <li><a href="https://legitbs.net">Homepage</a></li>
          <li><a href="https://twitter.com/legitbs_ctf">Twitter</a></li>
          <li><a href="https://github.com/legitbs">GitHub</a></li>
          <li><a href="https://github.com/legitbs/cgc-docs">This repo</a></li>
        </ul>
      </div>
    </footer>
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="../../../assets/javascripts/application.js"></script>
    <script>
      !function(l,e,g,i,t,b,s){l.GoogleAnalyticsObject=g;l[g]||(l[g]=function(){
      (l[g].q=l[g].q||[]).push(arguments)});l[g].l=+new Date;b=e.createElement(i);
      s=e.getElementsByTagName(i)[0];b.src=t;s.parentNode.insertBefore(b,s)}
      (window,document,'ga','script','//www.google-analytics.com/analytics.js');
      
      ga('create', 'UA-38870141-4', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
